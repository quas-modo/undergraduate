<!-- build time:Fri Oct 14 2022 10:57:57 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Carpe diem" href="https://quas-modo.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Carpe diem" href="https://quas-modo.github.io/atom.xml"><link rel="alternate" type="application/json" title="Carpe diem" href="https://quas-modo.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="计网"><link rel="canonical" href="https://quas-modo.github.io/2022/09/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/Lecture04-%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%B9%B3%E9%9D%A2/"><title>Lecture04-网络层：数据平面 - 计算机网络自顶向下 - 专业书籍 | quas-modo = Carpe diem = pluck the day</title><meta name="generator" content="Hexo 5.4.2"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Lecture04-网络层：数据平面</h1><div class="meta"><span class="item" title="创建时间：2022-09-21 20:00:27"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-09-21T20:00:27+08:00">2022-09-21</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>2.6k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>2 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">quas-modo</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipewr8iypj20zk0m8b29.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipexj2jgzj20zk0m8b09.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclga70tsj20zk0m84mr.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipeu7txpzj20zk0m81kx.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giph4fomxoj20zk0m8axp.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipexe4oykj20zk0m87ji.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E4%B8%93%E4%B8%9A%E4%B9%A6%E7%B1%8D/" itemprop="item" rel="index" title="分类于 专业书籍"><span itemprop="name">专业书籍</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E4%B8%93%E4%B8%9A%E4%B9%A6%E7%B1%8D/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/" itemprop="item" rel="index" title="分类于 计算机网络自顶向下"><span itemprop="name">计算机网络自顶向下</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://quas-modo.github.io/2022/09/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/Lecture04-%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%B9%B3%E9%9D%A2/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="quas-modo"><meta itemprop="description" content="pluck the day, notes/thoughts/nonsense"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Carpe diem"></span><div class="body md" itemprop="articleBody"><p>掌握 IP 编址就是掌握因特网的网络层！（雾）<br>Bulter Lampson—— 在一个时刻做一件事，将他做好。一个接口应当俘获一个抽象的最低限度的要件。不要进行一般化，一般化通常是错误的。<br><span id="more"></span></p><h1 id="第四章-网络层数据平面"><a class="anchor" href="#第四章-网络层数据平面">#</a> 第四章 网络层：数据平面</h1><h2 id="网络层概述"><a class="anchor" href="#网络层概述">#</a> 网络层概述</h2><h3 id="数据平面"><a class="anchor" href="#数据平面">#</a> <strong>数据平面</strong>：</h3><p>网络层中每台路由器的功能，决定到达路由器输入链路之一的数据报如何转发到该路由器的输出链路之一，每台路由器如何选择。</p><p>传统方式的转发功能基于目标地址和转发表，SDN 方式基于多个字段和流表。</p><h3 id="控制平面"><a class="anchor" href="#控制平面">#</a> <strong>控制平面</strong>：</h3><p>网络范围的逻辑，控制数据报沿着源主机到目的主机的端到端路径中路由器的路由方式，协调本地路由器的转发动作。</p><p>传统的路由方法在路由器中实现，SDN 方法在远程的服务器中实现。</p><p>传统方式，分布式的去做，控制平面和数据平面在一起完成。</p><p>SND 有一个统一的服务器，实现解耦合的功能。</p><h3 id="网络层功能"><a class="anchor" href="#网络层功能">#</a> <strong>网络层功能</strong>：</h3><ol><li>转发，在数据平面实现</li><li>路由选择，在控制平面中实现</li></ol><h3 id="网络服务模型"><a class="anchor" href="#网络服务模型">#</a> <strong>网络服务模型</strong></h3><h4 id="对于单个数据报服务"><a class="anchor" href="#对于单个数据报服务">#</a> 对于单个数据报服务</h4><ol><li>可靠传送</li><li>延迟保证</li></ol><h4 id="对于数据报流的服务"><a class="anchor" href="#对于数据报流的服务">#</a> 对于数据报流的服务</h4><ol><li>保序数据报传送</li><li>保证流的最小宽带</li><li>分组之间的延迟差</li></ol><h2 id="路由器工作原理"><a class="anchor" href="#路由器工作原理">#</a> 路由器工作原理</h2><p>路由器包括<strong>输入端口、交换结构、输出端口和路由选择处理器</strong>。</p><p>基于目标的转发：仅仅依赖于 IP 数据报的目标 IP 地址。</p><p>通用转发：基于头部字段的任意集合进行转发。</p><p><strong>“匹配” 加 “动作”</strong></p><h3 id="输入端口和基于目的地转发"><a class="anchor" href="#输入端口和基于目的地转发">#</a> 输入端口和基于目的地转发</h3><h4 id="查找"><a class="anchor" href="#查找">#</a> 查找</h4><p>使用转发表来查找输出端口</p><p>路由器用分组目的地址的前缀与该表中的表项进行匹配。当有多个匹配时，使用<strong>最长前缀匹配规则</strong>。</p><h4 id="其他动作"><a class="anchor" href="#其他动作">#</a> 其他动作</h4><ul><li>出现物理层和链路层处理</li><li>检查分组的版本号、检验和以及寿命字段</li><li>必须更新用于网络管理的计数器</li></ul><h4 id="输入端口缓存"><a class="anchor" href="#输入端口缓存">#</a> 输入端口缓存</h4><p>排队延迟以及由于输入缓存溢出造成丢失</p><h3 id="交换"><a class="anchor" href="#交换">#</a> 交换</h3><ol><li><p>经内存交换</p><p>先将分组存入内存，再将分组复制到输出端口</p></li><li><p>经总线交换</p><p>一次只有一个分组能够快约总线，路由器的交换带宽受总线速率的限制。</p></li><li><p>经互联网络交换</p><p>使用更复杂的互联网络，例如使用纵横式交换机、榕树网络，纵横式交换机就是一种由 2N 条总线组成的互联网络。</p></li></ol><h3 id="输出端口处理"><a class="anchor" href="#输出端口处理">#</a> 输出端口处理</h3><p>取出排队的分组进行传输，执行所需的链路层和物理层传输功能。</p><h3 id="何处出现排队"><a class="anchor" href="#何处出现排队">#</a> 何处出现排队</h3><h4 id="输入排队"><a class="anchor" href="#输入排队">#</a> 输入排队</h4><p>HOL 阻塞 Head-Of-the-Line 线路前端阻塞</p><p>只要输入链路上的分组到达速率达到其容量的 58%，在某些假设前提下，输入队列长度就会无限制地增大。</p><h4 id="输出排队"><a class="anchor" href="#输出排队">#</a> 输出排队</h4><p>如何丢弃？</p><ul><li>弃尾</li><li>根据优先权</li><li>随机丢弃</li></ul><h4 id="分组调度"><a class="anchor" href="#分组调度">#</a> 分组调度</h4><ol><li><p>先进先出</p><p>FIFO first in first out</p><p>FCFS first come first service</p></li><li><p>优先权排队</p><p>优先权高的先进行传输</p><p>非抢占式优先权排队：一旦分组开始传输，就不能打断</p></li><li><p>循环和加权公平排队</p><p>保持工作排队，不允许链路保持空闲</p><p>类 n 的分组传输完毕后，就传输类 n+1 的分组，如果该类暂时没有分组，就跳到下一个类进行传输。</p><p>每类的服务时间可能是带有权重的。</p></li></ol><h2 id="网络协议"><a class="anchor" href="#网络协议">#</a> 网络协议</h2><p>以网络为单位来访问和向外传输</p><p>掌握 IP 编址就是掌握因特网的网络层！</p><h3 id="ipv4数据报格式"><a class="anchor" href="#ipv4数据报格式">#</a> IPv4 数据报格式</h3><p>版本</p><p>首部长度</p><p>服务类型</p><p>数据报长度</p><p>16 比特标识</p><p>标志</p><p>13 比特片偏移</p><p>寿命</p><p>上层协议</p><p>首部检验和</p><p>32 位比特源 IP 地址</p><p>32 比特目标 IP 地址</p><p>数据</p><h3 id="数据报分片"><a class="anchor" href="#数据报分片">#</a> 数据报分片</h3><p>因为<strong>最大传送单元（MTU Maximum Transmission Unit）在链路层</strong>的限制，IP 数据报的长度有限，并且，不同链路也许会有不同的链路层协议，有不同的 MTU，所以要对于数据报做一些调整。</p><p>分片，重新组装，标记<strong>表示、标志和片偏移字段</strong>【20 字节头部、数据、偏移量、最后一片的标志比特为 0】</p><h3 id="ipv4编址"><a class="anchor" href="#ipv4编址">#</a> IPv4 编址</h3><p>32 比特（4 字节），共有约 40 亿个。</p><p>点分十进制记法</p><p>无类别域间路由选择 a.b.c.d/x</p><p>为了确定子网，分开主机和路由器的每个接口，产生几个隔离的网络岛，使用接口端接这些隔离的网络的端点。这些隔离的网络中的每一个都叫作一个子网。</p><h4 id="分类编址"><a class="anchor" href="#分类编址">#</a> 分类编址：</h4><ol><li>A 类 1/7/24</li><li>B 类 2/14/16</li><li>C 类 3/21/8</li></ol><h4 id="特殊的地址"><a class="anchor" href="#特殊的地址">#</a> 特殊的地址：</h4><ol><li><p>全 0 - 本网络、本主机</p></li><li><p>全 1 - 广播</p></li><li><p>127.x.x.x 回路地址</p></li><li><p>专用网络地址</p><ul><li>A 10.0.0.0-10.255.255.255</li><li>B 172.16.0.0-172.31.255.255</li><li>C 192.168.0.0-192.168.255.255</li></ul></li></ol><h4 id="主机如何获得ip地址"><a class="anchor" href="#主机如何获得ip地址">#</a> 主机如何获得 IP 地址？</h4><ol><li><p>获取一块地址</p><p>从一个 ISP 获取一组地址，例如该 ISP 被分配了地址 200.23.16.0/20，ISP 可以将地址块分成八个长度相等的连续地址块</p><p>ICANN Internet Corporation for Assigned Names and Numbers 分配地址的机构</p></li><li><p>获取主机地址：动态主机配置协议</p><p>DHCP Dynamic Host Configuration 动态主机配置协议 即插即用协议 零配置协议</p><p>DHCP 建立在 UDP 上</p><ol><li>DHCP 服务器发现</li><li>DHCP 服务器提供</li><li>DHCP 请求</li><li>DHCP ACK</li></ol></li></ol><h3 id="网络地址转换"><a class="anchor" href="#网络地址转换">#</a> 网络地址转换</h3><p>NAT Network Address Translation 网络地址转换</p><p>专用网络 / 具有专用地址的网络 —— 其地址仅对该网络中的设备有意义的网络</p><p>局域网的地址仅在自己内部有效。</p><p>与外界通信利用<strong> NAT 转换表</strong>，记录对应的 WAN 端和 LAN 端的 IP 地址和端口号。</p><p>但是会造成 NAT 穿越问题（客户端如何和网络内部的端系统建立链接）。</p><h3 id="安全性"><a class="anchor" href="#安全性">#</a> 安全性</h3><h4 id="防火墙"><a class="anchor" href="#防火墙">#</a> 防火墙</h4><p>阻挡所有的 ICMP 回显请求分组</p><p>基于源和目标 IP 端口号阻挡</p><p>跟踪 TCP 连接</p><h4 id="入侵检测系统"><a class="anchor" href="#入侵检测系统">#</a> 入侵检测系统</h4><p>检查数据报的首部字段和有效载荷，匹配数据库中的特征，如果发现匹配，则产生告警。</p><h3 id="ipv6"><a class="anchor" href="#ipv6">#</a> IPv6</h3><p>IP 地址更新为 128 比特</p><p>删去的字段：取消分片与重新组装（丢给端系统）、取消首部检验和（丢给链路层和运输层），这些都是为了加快网络中的 IP 转发速度，除去（甩锅）冗余的步骤</p><h4 id="ipv4和ipv6之间如何通信"><a class="anchor" href="#ipv4和ipv6之间如何通信">#</a> IPv4 和 IPv6 之间如何通信</h4><p>采用<strong>隧道</strong>，比如说，两个 IPv6 的地址进行通信，可以把整个 IPv6 的数据报放到 IPv4 数据报的有效载荷字段当中。</p><h2 id="通用转发和sdn"><a class="anchor" href="#通用转发和sdn">#</a> 通用转发和 SDN</h2><p>匹配 + 动作</p><p>通用转发基于<strong> OpenFlow</strong> 的讨论，匹配加动作转发表在 OpenFlow 中称为<strong>流表（flow table）</strong>，它的每个表项包括：</p><ol><li>首部字段值的集合</li><li>计数器集合</li><li>当分组匹配流表项时采取的动作集合</li></ol><h3 id="匹配"><a class="anchor" href="#匹配">#</a> 匹配</h3><p>OpenFlow 匹配入端口、链路层字段、网络层字段、运输层字段</p><h3 id="动作"><a class="anchor" href="#动作">#</a> 动作</h3><ul><li>转发</li><li>丢弃</li><li>修改字段</li></ul><h2 id="其他"><a class="anchor" href="#其他">#</a> 其他</h2><p>网络层中的设备过多</p><p>数量众多、功能各异的中间盒</p><h3 id="传统方式实现网络功能的问题"><a class="anchor" href="#传统方式实现网络功能的问题">#</a> 传统方式实现网络功能的问题</h3><ol><li><p>垂直集成》昂贵，不利于创造新的生态</p></li><li><p>分布式、固化设备功能、网络设备朱磊繁多</p></li><li><p>管理困难</p></li><li><p>流量工程较为困难</p></li></ol><h3 id="sdn"><a class="anchor" href="#sdn">#</a> SDN</h3><p>SDN 远程集中，将数据平面和控制平面分离</p><ol><li><p>水平集成</p></li><li><p>业界生态开放，快速创新</p></li><li><p>产业巨大</p></li></ol><div class="tags"><a href="/tags/%E8%AE%A1%E7%BD%91/" rel="tag"><i class="ic i-tag"></i> 计网</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-09-21 20:03:11" itemprop="dateModified" datetime="2022-09-21T20:03:11+08:00">2022-09-21</time> </span><span id="2022/09/21/计算机网络自顶向下/Lecture04-网络层：数据平面/" class="item leancloud_visitors" data-flag-title="Lecture04-网络层：数据平面" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.jpg" alt="quas-modo 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.jpg" alt="quas-modo 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="quas-modo 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>quas-modo <i class="ic i-at"><em>@</em></i>Carpe diem</li><li class="link"><strong>本文链接：</strong> <a href="https://quas-modo.github.io/2022/09/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/Lecture04-%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%B9%B3%E9%9D%A2/" title="Lecture04-网络层：数据平面">https://quas-modo.github.io/2022/09/21/计算机网络自顶向下/Lecture04-网络层：数据平面/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/09/20/%E8%A5%BF%E6%96%B9%E7%BE%8E%E6%9C%AF%E5%8F%B2/Lecture01-%E5%8F%B2%E5%89%8D%E5%8F%8A%E5%9F%83%E5%8F%8A%E7%BE%8E%E6%9C%AF/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicis3attqj20zk0m8k7l.jpg" title="Lecture01 史前及埃及美术"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 西方美术史</span><h3>Lecture01 史前及埃及美术</h3></a></div><div class="item right"><a href="/2022/09/21/cpp/Lecture04-%E7%AC%AC%E4%B8%80%E6%AC%A1cpp%E7%BC%96%E7%A8%8B/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicm07ih54j20zk0m84qp.jpg" title="Lecture04-第一次cpp编程"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> cpp</span><h3>Lecture04-第一次cpp编程</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%B1%82%E6%95%B0%E6%8D%AE%E5%B9%B3%E9%9D%A2"><span class="toc-number">1.</span> <span class="toc-text">第四章 网络层：数据平面</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">网络层概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%B9%B3%E9%9D%A2"><span class="toc-number">1.1.1.</span> <span class="toc-text">数据平面：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%B9%B3%E9%9D%A2"><span class="toc-number">1.1.2.</span> <span class="toc-text">控制平面：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E5%8A%9F%E8%83%BD"><span class="toc-number">1.1.3.</span> <span class="toc-text">网络层功能：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.1.4.</span> <span class="toc-text">网络服务模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E4%BA%8E%E5%8D%95%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">对于单个数据报服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E4%BA%8E%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%B5%81%E7%9A%84%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">对于数据报流的服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">路由器工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E7%AB%AF%E5%8F%A3%E5%92%8C%E5%9F%BA%E4%BA%8E%E7%9B%AE%E7%9A%84%E5%9C%B0%E8%BD%AC%E5%8F%91"><span class="toc-number">1.2.1.</span> <span class="toc-text">输入端口和基于目的地转发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">查找</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%8A%A8%E4%BD%9C"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">其他动作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E7%AB%AF%E5%8F%A3%E7%BC%93%E5%AD%98"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">输入端口缓存</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2"><span class="toc-number">1.2.2.</span> <span class="toc-text">交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E7%AB%AF%E5%8F%A3%E5%A4%84%E7%90%86"><span class="toc-number">1.2.3.</span> <span class="toc-text">输出端口处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%95%E5%A4%84%E5%87%BA%E7%8E%B0%E6%8E%92%E9%98%9F"><span class="toc-number">1.2.4.</span> <span class="toc-text">何处出现排队</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%8E%92%E9%98%9F"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">输入排队</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E6%8E%92%E9%98%9F"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">输出排队</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E8%B0%83%E5%BA%A6"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">分组调度</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.</span> <span class="toc-text">网络协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ipv4%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.3.1.</span> <span class="toc-text">IPv4 数据报格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%88%86%E7%89%87"><span class="toc-number">1.3.2.</span> <span class="toc-text">数据报分片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ipv4%E7%BC%96%E5%9D%80"><span class="toc-number">1.3.3.</span> <span class="toc-text">IPv4 编址</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">分类编址：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E7%9A%84%E5%9C%B0%E5%9D%80"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">特殊的地址：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E5%A6%82%E4%BD%95%E8%8E%B7%E5%BE%97ip%E5%9C%B0%E5%9D%80"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">主机如何获得 IP 地址？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.3.4.</span> <span class="toc-text">网络地址转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E6%80%A7"><span class="toc-number">1.3.5.</span> <span class="toc-text">安全性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">防火墙</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">入侵检测系统</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ipv6"><span class="toc-number">1.3.6.</span> <span class="toc-text">IPv6</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ipv4%E5%92%8Cipv6%E4%B9%8B%E9%97%B4%E5%A6%82%E4%BD%95%E9%80%9A%E4%BF%A1"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">IPv4 和 IPv6 之间如何通信</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E8%BD%AC%E5%8F%91%E5%92%8Csdn"><span class="toc-number">1.4.</span> <span class="toc-text">通用转发和 SDN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D"><span class="toc-number">1.4.1.</span> <span class="toc-text">匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E4%BD%9C"><span class="toc-number">1.4.2.</span> <span class="toc-text">动作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">1.5.</span> <span class="toc-text">其他</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E7%BB%9F%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%BB%9C%E5%8A%9F%E8%83%BD%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.1.</span> <span class="toc-text">传统方式实现网络功能的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sdn"><span class="toc-number">1.5.2.</span> <span class="toc-text">SDN</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/09/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/Lecture01/" rel="bookmark" title="Lecture01">Lecture01</a></li><li><a href="/2022/09/11/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/Lecture02-%E5%BA%94%E7%94%A8%E5%B1%82/" rel="bookmark" title="Lecture02-应用层">Lecture02-应用层</a></li><li><a href="/2022/09/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/Lecture03-%E4%BC%A0%E8%BE%93%E5%B1%82/" rel="bookmark" title="Lecture03-传输层">Lecture03-传输层</a></li><li class="active"><a href="/2022/09/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/Lecture04-%E7%BD%91%E7%BB%9C%E5%B1%82%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%B9%B3%E9%9D%A2/" rel="bookmark" title="Lecture04-网络层：数据平面">Lecture04-网络层：数据平面</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="quas-modo" data-src="/images/avatar.jpg"><p class="name" itemprop="name">quas-modo</p><div class="description" itemprop="description">notes/thoughts/nonsense</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">22</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">11</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">7</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3F1YXMtbW9kbw==" title="https:&#x2F;&#x2F;github.com&#x2F;quas-modo"><i class="ic i-github"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/09/20/%E8%A5%BF%E6%96%B9%E7%BE%8E%E6%9C%AF%E5%8F%B2/Lecture01-%E5%8F%B2%E5%89%8D%E5%8F%8A%E5%9F%83%E5%8F%8A%E7%BE%8E%E6%9C%AF/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/09/21/cpp/Lecture04-%E7%AC%AC%E4%B8%80%E6%AC%A1cpp%E7%BC%96%E7%A8%8B/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/NJUSE/" title="分类于 NJUSE">NJUSE</a> <i class="ic i-angle-right"></i> <a href="/categories/NJUSE/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E4%B8%8E%E7%BB%93%E6%9E%84/" title="分类于 计算机组成与结构">计算机组成与结构</a></div><span><a href="/2022/09/23/COA/Lecture03-%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E8%A1%A8%E7%A4%BA/" title="Lecture03-数据的机器级表表示">Lecture03-数据的机器级表表示</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/NJUSE/" title="分类于 NJUSE">NJUSE</a> <i class="ic i-angle-right"></i> <a href="/categories/NJUSE/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E4%B8%8E%E7%BB%93%E6%9E%84/" title="分类于 计算机组成与结构">计算机组成与结构</a></div><span><a href="/2022/09/08/COA/Lecture01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/" title="Lecture01-计算机系统概述">Lecture01-计算机系统概述</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/NJUSE/" title="分类于 NJUSE">NJUSE</a> <i class="ic i-angle-right"></i> <a href="/categories/NJUSE/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E4%B8%8E%E7%BB%93%E6%9E%84/" title="分类于 计算机组成与结构">计算机组成与结构</a></div><span><a href="/2022/10/04/COA/Lecture04-%E6%95%B4%E6%95%B0%E8%BF%90%E7%AE%97/" title="Lecture04-整数运算">Lecture04-整数运算</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/NJUSE/" title="分类于 NJUSE">NJUSE</a> <i class="ic i-angle-right"></i> <a href="/categories/NJUSE/cpp/" title="分类于 cpp">cpp</a></div><span><a href="/2022/09/15/cpp/Lecture03-%E7%BB%93%E6%9E%84%E5%8C%96%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/" title="Lecture03-结构化程序设计">Lecture03-结构化程序设计</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%85%B6%E4%BB%96/" title="分类于 其他">其他</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%85%B6%E4%BB%96/%E8%A5%BF%E6%96%B9%E7%BE%8E%E6%9C%AF%E5%8F%B2/" title="分类于 西方美术史">西方美术史</a></div><span><a href="/2022/09/20/%E8%A5%BF%E6%96%B9%E7%BE%8E%E6%9C%AF%E5%8F%B2/Lecture01-%E5%8F%B2%E5%89%8D%E5%8F%8A%E5%9F%83%E5%8F%8A%E7%BE%8E%E6%9C%AF/" title="Lecture01 史前及埃及美术">Lecture01 史前及埃及美术</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%9D%82%E8%B0%88/" title="分类于 杂谈">杂谈</a> <i class="ic i-angle-right"></i> <a href="/categories/%E6%9D%82%E8%B0%88/%E4%B9%A6%E5%BD%B1%E9%9F%B3/" title="分类于 书影音">书影音</a></div><span><a href="/2022/09/07/thoughts/%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0%E6%88%91%E7%9A%84%E4%B8%96%E7%95%8C/" title="欢迎来到我的世界">欢迎来到我的世界</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%85%B6%E4%BB%96/" title="分类于 其他">其他</a> <i class="ic i-angle-right"></i> <a href="/categories/%E5%85%B6%E4%BB%96/%E8%A5%BF%E6%96%B9%E7%BE%8E%E6%9C%AF%E5%8F%B2/" title="分类于 西方美术史">西方美术史</a></div><span><a href="/2022/10/10/%E8%A5%BF%E6%96%B9%E7%BE%8E%E6%9C%AF%E5%8F%B2/Lecture02-03-%E5%8F%A4%E5%85%B8%E6%97%B6%E6%9C%9F-%E5%8F%A4%E7%BD%97%E9%A9%AC%E6%97%B6%E6%9C%9F/" title="Lecture02&#x2F;03 古典时期 古罗马时期">Lecture02/03 古典时期 古罗马时期</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/NJUSE/" title="分类于 NJUSE">NJUSE</a> <i class="ic i-angle-right"></i> <a href="/categories/NJUSE/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E4%B8%8E%E7%BB%93%E6%9E%84/" title="分类于 计算机组成与结构">计算机组成与结构</a></div><span><a href="/2022/09/15/COA/Lecture02-%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E7%9A%84%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="Lecture02-计算机体系结构的问题及解决方案">Lecture02-计算机体系结构的问题及解决方案</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E4%B8%93%E4%B8%9A%E4%B9%A6%E7%B1%8D/" title="分类于 专业书籍">专业书籍</a> <i class="ic i-angle-right"></i> <a href="/categories/%E4%B8%93%E4%B8%9A%E4%B9%A6%E7%B1%8D/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/" title="分类于 计算机网络自顶向下">计算机网络自顶向下</a></div><span><a href="/2022/09/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B/Lecture03-%E4%BC%A0%E8%BE%93%E5%B1%82/" title="Lecture03-传输层">Lecture03-传输层</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%9D%82%E8%B0%88/" title="分类于 杂谈">杂谈</a> <i class="ic i-angle-right"></i> <a href="/categories/%E6%9D%82%E8%B0%88/%E4%B9%A6%E5%BD%B1%E9%9F%B3/" title="分类于 书影音">书影音</a></div><span><a href="/2022/09/15/thoughts/%E8%87%AA%E6%9D%80%E4%B8%93%E5%8D%96%E5%BA%97/" title="自杀专卖店">自杀专卖店</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-quas-modo"></i> </span><span class="author" itemprop="copyrightHolder">quas-modo @ quas-modo</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">40k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">37 分钟</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/09/21/计算机网络自顶向下/Lecture04-网络层：数据平面/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->